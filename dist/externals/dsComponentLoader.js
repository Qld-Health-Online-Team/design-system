window.addEventListener("DOMContentLoaded",(function(){try{var e={datastore:{},userLocation:null,document:null,collection:null,webPath:null,init:function(){null===e.userLocation?e.getLocation():e.getCurrentDocument()},getLocation:function(){var t=QLD.utils.getLocalStorage("qld_user_location");if(null!==t)e.userLocation=JSON.parse(t),e.getCurrentDocument();else{var n={},a=document.getElementById("qld__hhs");null!==a&&(n.hhs_id=a.getAttribute("data-hhs")),e.userLocation=n,e.getCurrentDocument()}},getCurrentDocument:function(){var t=document.getElementById("qld__ds-params"),n=t?t.getAttribute("data-collection"):e.getParameterByName("collection"),a=t?t.getAttribute("data-path"):e.getParameterByName("path"),o=t?t.getAttribute("data-document"):e.getParameterByName("document"),i="undefined"!=typeof mdSchema?mdSchema:{};void 0!==i&&i&&(n=i.collection?i.collection:n,o=i.document?i.document:o,a=i.webPath?i.webPath:a),e.datastore.collection=n,null!==o&&o.length>0?(e.document=o,e.getAllData()):null!==a&&null!==n&&a.length>0&&n.length>0?serviceFinderData.collection(n).where("web_path","===",a).get().then((function(t){e.document=t[0].id})).catch((function(e){console.log(e)})).then((function(){e.getAllData()})):e.getAllData()},getAllData:function(){dsComponents.forEach((function(t){e.getComponentData(t)}))},getComponentData:function(t){var n=0,a=t.manifest.component.ds_queries;if(void 0!==a){var o=a.length;!function c(r){var l=a[r],s=e.datastore;if(s.hasOwnProperty(l.name))++n<o?c(n):e.renderComponent(t);else{var d=i(l.collection),m=serviceFinderData.collection(d);if(l.hasOwnProperty("document")){var u=i(l.document);m=m.doc(u)}else l.hasOwnProperty("filters")&&l.filters.forEach((function(e,t){var n=i(e.val1),a=i(e.val2),o=e.operator;0===t?m.where(n,o,a):m.and(n,o,a)}));m.get().then((function(e){s[l.name]=e})).catch((function(e){s[l.name]=null})).then((function(){++n<o?c(n):e.renderComponent(t)}))}}(n)}else e.renderComponent(t);function i(t){var n=e.userLocation?e.userLocation.hhs_id:document.getElementById("qld__hhs").getAttribute("data-hhs");return t=(t=(t=t.replace("<hhs>",n)).replace("<collection>",e.datastore.collection)).replace("<document>",e.document)}},renderComponent:function(t){if(void 0!==t.component&&t.component.length>0){var n=window.atob(t.component.replace('export default "data:text/x-handlebars-template;charset=utf-8;base64,',"").replace('"',""));n=n.replace(/\.\/\?a=/g,"")}var a=e.datastore,o={component:t.manifest.component,datastore:a,userLocation:e.userLocation,current:current,site:site,userData:userData,content:"Lorem Ipsum"};t.templateData&&(o.component.data=t.templateData),"undefined"!=typeof search&&(o.resultPacket=search.resultPacket,o.resultsSummary=search.resultsSummary,o.facets=search.facets,o.facetExtras=search.facetExtras,o.placeQuery=search.placeQuery,o.pagination=search.pagination);var i=a.collection?a.collection.replace(/_/g,"-"):null,c=e.getParameterByName("service_id");"admin"===t.type&&(o.collection=i,o.schema=t.schema?t.schema:t.schemas[i],o.parentService=c),"undefined"!=typeof sfLinks?o.links=sfLinks:o.links={home:"/sf_service_finder.html",serviceDetails:"/sf_service_page.html",serviceLocation:"/sf_service_location_page.html",facilityLocation:"/sf_facility_page.html",servicesAtoZ:"/sf_services_a-z.html",servicesSearch:"/sf_service_search.html"},"undefined"!=typeof sfAdminLinks?o.adminLinks=sfAdminLinks:o.adminLinks={list:"/sf_admin_list.html",form:"/sf_admin_form.html",view:"/sf_admin_details.html",topService:"/sf_admin_top_services_form.html",tinymceStyles:"/externals/tinymce_classes.css"};var r=null;if(void 0!==n?r=Handlebars.compile(n)(o).replace(/\.\/\?a=/g,""):void 0!==t.template&&(r=t.template(o)),document.getElementById("ds_component_"+t.id).outerHTML=r,$(".qld__service-finder-admin__list").length>0&&QLD.adminList.init(),$(".qld__service_finder_admin_form form").length>0&&QLD.adminForm.init(),$(".sf-admin__top-services-form form").length>0&&QLD.topServicesForm.init(),$(".qld__update-location-input").length>0&&QLD.userLocationFinder.init(),$(".qld__open-modal").length>0&&QLD.Modal.init(),$(".qld__service-finder").length>0&&QLD.servicesSearchForm.init(),$(".qld__service_search__facets").length>0&&QLD.servicesSearchFacets.init(),$(".js-map-embed-facility").length>0&&QLD.facilityMap.init(),$(".qld__content-tabs").length>0&&QLD.tabs.init(),$(".qld__service_search__facets .js-qld__accordion").length>0&&QLD.accordion.init(),location.hash){var l=location.hash.slice(1);location.hash="",location.hash=l}},getParameterByName:function(e,t){t=t||window.location.href,e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null},executeFunctionByName:function(e,t){for(var n=Array.prototype.slice.call(arguments,2),a=e.split("."),o=a.pop(),i=0;i<a.length;i++)t=t[a[i]];t[o].apply(t,n)}}}catch(e){console.log(e)}window.serviceFinder=e,"undefined"!=typeof dsComponents&&e.init()}));